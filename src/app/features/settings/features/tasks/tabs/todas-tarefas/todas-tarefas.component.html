<div class="card">
  <p-table [value]="tasks" styleClass="p-datatable-sm" [tableStyle]="{'min-width': '50rem'}">
    <ng-template pTemplate="header">
      <tr>
        <th>Título</th>
        <th>Prioridade</th>
        <th>Status</th>
        <th>Vencimento</th>
        <th>Responsável</th>
        <th>Ações</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-task>
      <tr>
        <td>
          <span class="font-bold">{{ task.title }}</span>
          <div class="text-sm text-gray-500 mt-1">{{ task.description }}</div>
        </td>
        <td>
          <p-tag [value]="task.priority === 'BAIXA' ? 'Baixa' : task.priority === 'MEDIA' ? 'Média' : 'Alta'" 
                [severity]="getPriorityColor(task.priority)"></p-tag>
        </td>
        <td>
          <p-tag [value]="task.status === 'PENDENTE' ? 'Pendente' : task.status === 'EM_ANDAMENTO' ? 'Em Andamento' : 'Concluída'" 
                [severity]="getStatusColor(task.status)"></p-tag>
        </td>
        <td>
          <span [ngClass]="{'text-red-500 font-bold': isTaskOverdue(task.dueDate) && task.status !== 'CONCLUIDA'}">
            {{ task.dueDate | date: 'dd/MM/yyyy' }}
          </span>
        </td>
        <td>{{ task.assignedTo || 'Não atribuído' }}</td>
        <td>
          <div class="flex gap-2">
            <button pButton *ngIf="task.status === 'PENDENTE'" 
                    class="p-button-sm p-button-info" 
                    icon="pi pi-play" 
                    (click)="atualizarStatus(task, 'EM_ANDAMENTO')"
                    pTooltip="Iniciar"></button>
            <button pButton *ngIf="task.status === 'EM_ANDAMENTO'" 
                    class="p-button-sm p-button-success" 
                    icon="pi pi-check" 
                    (click)="atualizarStatus(task, 'CONCLUIDA')"
                    pTooltip="Concluir"></button>
            <button pButton *ngIf="task.status === 'CONCLUIDA'" 
                    class="p-button-sm p-button-warning" 
                    icon="pi pi-refresh" 
                    (click)="atualizarStatus(task, 'PENDENTE')"
                    pTooltip="Reabrir"></button>
          </div>
        </td>
      </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="6" class="text-center p-4">
          Nenhuma tarefa encontrada.
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>