<div class="grid">
    <div class="col-12">
        <div class="card">
            <h5>Funções e Permissões</h5>
            <p>Gerencie as funções e permissões do funcionário.</p>

            <!-- Current Roles -->
            <div class="mb-5">
                <h6>Função Atual</h6>
                <p-table [value]="employee!.allPermissions" [loading]="loading" styleClass="p-datatable-sm"
                    [tableStyle]="{'min-width': '50rem'}">
                    <ng-template pTemplate="header">
                        <tr>
                            <th>Nome</th>
                            <th>Ações</th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-permission>
                        <tr>
                            <td>{{ permission.name }}</td>
                            <td>
                                <button pButton pRipple icon="pi pi-trash"
                                    class="p-button-rounded p-button-danger p-button-text"
                                    (click)="removePermission(permission)" [disabled]="removing"></button>
                            </td>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="emptymessage">
                        <tr>
                            <td colspan="4" class="text-center">
                                <div class="p-4">
                                    Nenhuma permissão atribuída a este funcionário.
                                </div>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>

            <!-- Add Role -->
            <div>
                <h6>Adicionar Permissão</h6>
                <div class="grid">
                    <div class="col-12 md:col-6">
                        <p-dropdown [options]="availablePermissions" [(ngModel)]="selectedPermission" optionLabel="name"
                            placeholder="Selecione uma função" [showClear]="true" styleClass="w-full"></p-dropdown>
                    </div>
                    <div class="col-12 md:col-6">
                        <button pButton pRipple label="Adicionar Função" icon="pi pi-plus" (click)="addRole()"
                            [disabled]="!selectedPermission || adding"></button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Loading Spinner -->
<div class="grid" *ngIf="loading">
    <div class="col-12 flex justify-content-center">
        <p-progressSpinner></p-progressSpinner>
    </div>
</div>
