<div class="grid">
    <div class="col-12">
        <div class="card">
            <h5>Gerenciar Permissões</h5>
            <p>Adicione ou remova permissões para esta função.</p>

            <!-- Current Permissions -->
            <div class="mb-5">
                <h6>Permissões Atuais</h6>
                <p-table [value]="role?.permissions || []" [loading]="loading" styleClass="p-datatable-sm"
                         [tableStyle]="{'min-width': '50rem'}">
                    <ng-template pTemplate="header">
                        <tr>
                            <th>Nome</th>
                            <th>Descrição</th>
                            <th>Ações</th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-permission>
                        <tr>
                            <td>{{ permission.name }}</td>
                            <td>{{ permission.description }}</td>
                            <td>
                                <button pButton pRipple icon="pi pi-trash"
                                        class="p-button-rounded p-button-danger p-button-text"
                                        (click)="removePermission(permission)"
                                        [disabled]="removing"></button>
                            </td>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="emptymessage">
                        <tr>
                            <td colspan="4" class="text-center">
                                <div class="p-4">
                                    Nenhuma permissão atribuída a esta função.
                                </div>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>

            <!-- Add Permission -->
            <div>
                <h6>Adicionar Permissão</h6>
                <div class="grid">
                    <div class="col-12 md:col-6">
                        <p-dropdown [options]="availablePermissions" [(ngModel)]="selectedPermission" optionLabel="name"
                                    placeholder="Selecione uma permissão" [showClear]="true"
                                    styleClass="w-full"></p-dropdown>
                    </div>
                    <div class="col-12 md:col-6">
                        <button pButton pRipple label="Adicionar Permissão" icon="pi pi-plus"
                                (click)="addPermission()"
                                [disabled]="!selectedPermission || adding"></button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Loading Spinner -->
<div class="grid" *ngIf="loading">
    <div class="col-12 flex justify-content-center">
        <p-progressSpinner></p-progressSpinner>
    </div>
</div>

<!-- Toast Messages -->
<p-toast></p-toast>
