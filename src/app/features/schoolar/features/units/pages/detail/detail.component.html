<div *ngIf="loading" class="spinner-container">
    <p-progressSpinner styleClass="custom-spinner" fill="#EEEEEE"></p-progressSpinner>
</div>

<div class="grid" *ngIf="!loading && editableUnit">
    <div class="col-12">
        <div class="card">
            <h5>Detalhes da Unidade</h5>
            <div class="p-fluid grid">
                <div class="field col-12 md:col-6">
                    <label for="name">Nome</label>
                    <input id="name" type="text" pInputText [(ngModel)]="editableUnit.name"/>
                </div>

                <div class="field col-12 md:col-6">
                    <label for="description">Descrição</label>
                    <textarea id="description" pInputTextarea [(ngModel)]="editableUnit.description"></textarea>
                </div>

                <div class="field col-12 md:col-6">
                    <label for="orderUnit">Ordem da Unidade</label>
                    <input id="orderUnit" type="number" pInputText [(ngModel)]="editableUnit.orderUnit"/>
                </div>

                <div class="field col-12 md:col-6">
                    <label for="level">Nível</label>
                    <input id="level" type="text" pInputText [value]="editableUnit.level?.name" readonly/>

                </div>
            </div>

            <div class="flex justify-content-end gap-2 mt-4">
                <button
                    pButton
                    pRipple
                    label="Editar"
                    icon="pi pi-pencil"
                    class="p-button-primary"
                    (click)="editUnit()"
                ></button>
                <button
                    pButton
                    pRipple
                    label="Descarregar"
                    icon="pi pi-download"
                    class="p-button-secondary"
                    (click)="downloadUnitDetails()"
                ></button>
                <button
                    pButton
                    pRipple
                    label="Enviar"
                    icon="pi pi-send"
                    class="p-button-secondary"
                    (click)="sendUnitDetails()"
                ></button>
            </div>
        </div>
    </div>

    <!-- Dashboard Charts Section -->
    <div class="col-12">
        <div class="card">
            <h5>Dashboard da Unidade</h5>

            <!-- Progress and Assessment Charts Row -->
            <div class="grid">
                <!-- Student Progress Chart -->
                <div class="col-12 md:col-6">
                    <div class="card mb-0">
                        <p-chart
                            type="doughnut"
                            [data]="progressChartData"
                            [options]="progressChartOptions"
                            height="300px">
                        </p-chart>
                    </div>
                </div>

                <!-- Assessment Performance Chart -->
                <div class="col-12 md:col-6">
                    <div class="card mb-0">
                        <p-chart
                            type="bar"
                            [data]="assessmentChartData"
                            [options]="assessmentChartOptions"
                            height="300px">
                        </p-chart>
                    </div>
                </div>
            </div>

            <!-- Lesson Distribution Chart Row -->
            <div class="grid mt-3">
                <div class="col-12">
                    <div class="card mb-0">
                        <p-chart
                            type="pie"
                            [data]="lessonDistributionData"
                            [options]="lessonDistributionOptions"
                            height="300px">
                        </p-chart>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
