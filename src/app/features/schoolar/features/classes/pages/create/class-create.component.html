<!-- class-create.component.html -->
<div class="grid">
    <p-toast></p-toast>
    <div class="col-12">
        <p-card>
            <ng-template pTemplate="title">
                <h2>Criar nova turma</h2>
            </ng-template>
            <ng-template pTemplate="content">
                <form [formGroup]="classForm" class="grid p-fluid">
                    <div class="col-12 md:col-6 field">
                        <label for="name" class="font-bold">Nome *</label>
                        <input
                            id="name"
                            type="text"
                            pInputText
                            formControlName="name"
                            [class.ng-invalid]="isFieldInvalid('name')"
                            [class.ng-dirty]="classForm.get('name')?.dirty">
                        <small class="p-error" *ngIf="isFieldInvalid('name')">
                            {{ getFieldError('name') }}
                        </small>
                    </div>

                    <div class="col-12 md:col-6 field">
                        <label for="code" class="font-bold">Code *</label>
                        <input
                            id="code"
                            type="text"
                            pInputText
                            formControlName="code"
                            [class.ng-invalid]="isFieldInvalid('code')"
                            [class.ng-dirty]="classForm.get('code')?.dirty">
                        <small class="p-error" *ngIf="isFieldInvalid('code')">
                            {{ getFieldError('code') }}
                        </small>
                    </div>

                    <div class="col-12 md:col-6 field">
                        <label for="level" class="font-bold">Nível</label>
                        <p-dropdown
                            id="level"
                            [options]="levels"
                            formControlName="levelId"
                            optionLabel="label"
                            optionValue="value"
                            placeholder="Selecione um nível"
                            [showClear]="true">
                        </p-dropdown>
                    </div>

                    <div class="col-12 md:col-6 field">
                        <label for="center" class="font-bold">Centro</label>
                        <p-dropdown
                            id="center"
                            [options]="centers"
                            formControlName="centerId"
                            optionLabel="label"
                            optionValue="value"
                            placeholder="Selecione um centro"
                            [showClear]="true">
                        </p-dropdown>
                    </div>

                    <div class="col-12 md:col-6 field">
                        <label for="capacity" class="font-bold">Capacidade</label>
                        <p-inputNumber
                            id="capacity"
                            formControlName="maxCapacity"
                            [min]="1"
                            [max]="100"
                            [class.ng-invalid]="isFieldInvalid('maxCapacity')"
                            [class.ng-dirty]="classForm.get('maxCapacity')?.dirty">
                        </p-inputNumber>
                        <small class="p-error" *ngIf="isFieldInvalid('maxCapacity')">
                            {{ getFieldError('maxCapacity') }}
                        </small>
                    </div>

                    <div class="col-12 md:col-6 field">
                        <label for="status" class="font-bold">Estado</label>
                        <p-dropdown
                            id="status"
                            [options]="statuses"
                            formControlName="status"
                            optionLabel="label"
                            optionValue="value"
                            placeholder="Select a status"
                            [showClear]="true">
                        </p-dropdown>
                    </div>
                </form>
            </ng-template>
            <ng-template pTemplate="footer">
                <div class="flex justify-content-end">
                    <button pButton label="Cancel" icon="pi pi-times" class="p-button-text mr-2"></button>
                    <button
                        pButton
                        label="{{ (loading$| async) ? 'Salvando...':'Salvar' }}"
                        icon="pi pi-check"
                        (click)="saveClass()"
                        [disabled]="classForm.invalid">
                    </button>
                </div>
            </ng-template>
        </p-card>
    </div>
</div>
