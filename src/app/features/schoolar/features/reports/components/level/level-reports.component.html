<div class="grid">
  <div class="col-12">
    <div class="card">
      <h5>Relatórios de Cursos</h5>
      <div class="p-fluid grid">
        <div class="field col-12 md:col-4">
          <label for="reportType">Tipo de Relatório</label>
          <p-dropdown
            id="reportType"
            [options]="reportTypes"
            [(ngModel)]="selectedReportType"
            optionLabel="name"
            placeholder="Selecione um tipo de relatório"
            [showClear]="true">
          </p-dropdown>
        </div>

        <div class="field col-12 md:col-4">
          <label for="dateRange">Período</label>
          <p-calendar
            id="dateRange"
            [(ngModel)]="dateRange"
            selectionMode="range"
            [readonlyInput]="true"
            placeholder="Selecione um período"
            dateFormat="dd/mm/yy">
          </p-calendar>
        </div>

        <div class="field col-12 md:col-4 flex align-items-end">
          <button
            pButton
            pRipple
            label="Gerar Relatório"
            icon="pi pi-chart-bar"
            class="p-button-primary"
            (click)="generateReport()">
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Report Display Section -->
  <div class="col-12" *ngIf="reportGenerated">
    <div class="card">
      <div class="flex justify-content-between align-items-center mb-5">
        <h5>{{ selectedReportType?.name }}</h5>
        <div class="flex gap-2">
          <button
            pButton
            pRipple
            label="Exportar"
            icon="pi pi-download"
            class="p-button-secondary"
            (click)="exportReport()">
          </button>
          <button
            pButton
            pRipple
            label="Imprimir"
            icon="pi pi-print"
            class="p-button-secondary"
            (click)="printReport()">
          </button>
        </div>
      </div>

      <!-- Report Chart -->
      <div class="grid">
        <div class="col-12">
          <p-chart
            [type]="selectedReportType?.code === 'student-progress' ? 'doughnut' :
                   selectedReportType?.code === 'level-performance' ? 'pie' : 'bar'"
            [data]="reportData"
            [options]="reportOptions"
            height="400px">
          </p-chart>
        </div>
      </div>

      <!-- Report Summary -->
      <div class="grid mt-4">
        <div class="col-12">
          <h6>Resumo do Relatório</h6>
          <p>Este relatório mostra os dados de {{ selectedReportType?.name }} para o período selecionado.</p>

          <div class="mt-3" *ngIf="selectedReportType?.code === 'student-progress'">
            <p><strong>Alunos que concluíram:</strong> 65%</p>
            <p><strong>Alunos em progresso:</strong> 25%</p>
            <p><strong>Alunos que não iniciaram:</strong> 10%</p>
          </div>

          <div class="mt-3" *ngIf="selectedReportType?.code === 'unit-performance'">
            <p><strong>Unidade com melhor desempenho:</strong> Unit 4 (90%)</p>
            <p><strong>Unidade com pior desempenho:</strong> Unit 2 (72%)</p>
            <p><strong>Média geral:</strong> 81.4%</p>
          </div>

          <div class="mt-3" *ngIf="selectedReportType?.code === 'level-performance'">
            <p><strong>Nível com mais alunos:</strong> Elementary (40%)</p>
            <p><strong>Nível com menos alunos:</strong> Advanced (10%)</p>
            <p><strong>Total de alunos:</strong> 500</p>
          </div>

          <div class="mt-3" *ngIf="selectedReportType?.code === 'course-stats'">
            <p><strong>Total de matrículas:</strong> 396</p>
            <p><strong>Total de conclusões:</strong> 248</p>
            <p><strong>Taxa de conclusão:</strong> 62.6%</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
